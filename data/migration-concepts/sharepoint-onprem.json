{
  "id": "sharepoint-onprem",
  "name": "SharePoint On-Premises to Microsoft 365",
  "description": "SharePoint On-Premises to Microsoft 365 migration with InfoPath to Power Apps transformation",
  "dataSource": "data/sharepoint-onprem-data.json",
  "sourceEnvironment": {
    "name": "source",
    "title": "SharePoint On-Premises",
    "description": "On-premises SharePoint Server environment",
    "buckets": [
      {
        "id": "source-users",
        "title": "AD Users",
        "objectType": "ad-user",
        "layout": { "gridColumn": 1, "gridRow": 1 }
      },
      {
        "id": "source-security-groups",
        "title": "AD Security Groups",
        "objectType": "ad-security-group",
        "layout": { "gridColumn": 2, "gridRow": 1 }
      },
      {
        "id": "source-sharepoint-sites",
        "title": "SharePoint Sites",
        "objectType": "sp-onprem-site",
        "layout": { "gridColumn": 3, "gridRow": 1 }
      },
      {
        "id": "source-infopath-forms",
        "title": "InfoPath Forms",
        "objectType": "infopath-form",
        "layout": { "gridColumn": 1, "gridRow": 2 }
      },
      {
        "id": "source-workflows",
        "title": "Workflows",
        "objectType": "sp-workflow",
        "layout": { "gridColumn": 2, "gridRow": 2 }
      }
    ]
  },
  "targetEnvironment": {
    "name": "destination",
    "title": "Microsoft 365",
    "description": "Microsoft 365 cloud environment with modern capabilities",
    "buckets": [
      {
        "id": "destination-users",
        "title": "Entra ID Users",
        "objectType": "entra-user",
        "layout": { "gridColumn": 1, "gridRow": 1 }
      },
      {
        "id": "destination-security-groups",
        "title": "Entra ID Security Groups",
        "objectType": "entra-security-group",
        "layout": { "gridColumn": 2, "gridRow": 1 }
      },
      {
        "id": "destination-sharepoint-online",
        "title": "SharePoint Online",
        "objectType": "sp-online-site",
        "layout": { "gridColumn": 3, "gridRow": 1 }
      },
      {
        "id": "destination-power-apps",
        "title": "Power Apps",
        "objectType": "power-app",
        "layout": { "gridColumn": 1, "gridRow": 2 }
      },
      {
        "id": "destination-power-automate",
        "title": "Power Automate",
        "objectType": "power-automate-flow",
        "layout": { "gridColumn": 2, "gridRow": 2 }
      }
    ]
  },
  "objectTypes": {
    "ad-user": {
      "name": "AD User",
      "pluralName": "AD Users",
      "icon": "fa-user",
      "color": "#64b5f6",
      "dataProperties": {
        "collection": "Users",
        "idField": "id",
        "nameField": "DisplayName",
        "additionalFields": ["Email", "Title", "Department", "SamAccountName", "Domain"]
      }
    },
    "ad-security-group": {
      "name": "AD Security Group",
      "pluralName": "AD Security Groups",
      "icon": "fa-users",
      "color": "#7e57c2",
      "dataProperties": {
        "collection": "SecurityGroups",
        "idField": "id",
        "nameField": "DisplayName",
        "additionalFields": ["Description", "Members", "SamAccountName", "Domain"]
      }
    },
    "sp-onprem-site": {
      "name": "SharePoint Site",
      "pluralName": "SharePoint Sites",
      "icon": "fa-server",
      "color": "#2e7d32",
      "dataProperties": {
        "collection": "SharePointSites",
        "idField": "id",
        "nameField": "DisplayName",
        "additionalFields": ["URL", "Server", "TemplateType", "StorageUsed", "SharePointVersion"]
      }
    },
    "infopath-form": {
      "name": "InfoPath Form",
      "pluralName": "InfoPath Forms",
      "icon": "fa-wpforms",
      "color": "#607d8b",
      "dataProperties": {
        "collection": "InfoPathForms",
        "idField": "id",
        "nameField": "DisplayName",
        "additionalFields": ["FormTemplate", "FormLibrary", "FormVersion", "SubmissionCount"]
      }
    },
    "sp-workflow": {
      "name": "Workflow",
      "pluralName": "Workflows",
      "icon": "fa-project-diagram",
      "color": "#9c27b0",
      "dataProperties": {
        "collection": "Workflows",
        "idField": "id",
        "nameField": "DisplayName",
        "additionalFields": ["WorkflowType", "AssociatedList", "InstancesCompleted", "ApprovalSteps"]
      }
    },
    "entra-user": {
      "name": "Entra ID User",
      "pluralName": "Entra ID Users",
      "icon": "fa-user",
      "color": "#64b5f6",
      "dataProperties": {
        "collection": "Users",
        "idField": "id",
        "nameField": "DisplayName",
        "additionalFields": ["Email", "Title", "Department"]
      }
    },
    "entra-security-group": {
      "name": "Entra ID Security Group",
      "pluralName": "Entra ID Security Groups",
      "icon": "fa-users",
      "color": "#7e57c2",
      "dataProperties": {
        "collection": "SecurityGroups",
        "idField": "id",
        "nameField": "DisplayName",
        "additionalFields": ["Description", "Members"]
      }
    },
    "sp-online-site": {
      "name": "SharePoint Online Site",
      "pluralName": "SharePoint Online Sites",
      "icon": "fa-share-alt",
      "color": "#4caf50",
      "dataProperties": {
        "collection": "SharePointSites",
        "idField": "id",
        "nameField": "DisplayName",
        "additionalFields": ["URL", "TemplateType", "StorageUsed"]
      }
    },
    "power-app": {
      "name": "Power App",
      "pluralName": "Power Apps",
      "icon": "fa-mobile-alt",
      "color": "#742774",
      "dataProperties": {
        "collection": "InfoPathForms",
        "idField": "id",
        "nameField": "DisplayName",
        "additionalFields": ["AppType", "Environment"]
      }
    },
    "power-automate-flow": {
      "name": "Power Automate Flow",
      "pluralName": "Power Automate Flows",
      "icon": "fa-bolt",
      "color": "#0066ff",
      "dataProperties": {
        "collection": "Workflows",
        "idField": "id",
        "nameField": "DisplayName",
        "additionalFields": ["State", "TriggerType", "Runs"]
      }
    }
  },
  "mappings": [
    {
      "sourceType": "ad-user",
      "targetType": "entra-user"
    },
    {
      "sourceType": "ad-security-group",
      "targetType": "entra-security-group"
    },
    {
      "sourceType": "sp-onprem-site",
      "targetType": "sp-online-site",
      "transformations": {
        "icon": "fa-share-alt",
        "color": "#4caf50",
        "nameTransform": "append_modern"
      }
    },
    {
      "sourceType": "infopath-form",
      "targetType": "power-app",
      "transformations": {
        "icon": "fa-mobile-alt",
        "color": "#742774",
        "nameTransform": "append_powerapp"
      }
    },
    {
      "sourceType": "sp-workflow",
      "targetType": "power-automate-flow",
      "transformations": {
        "icon": "fa-bolt",
        "color": "#0066ff",
        "nameTransform": "append_flow"
      }
    }
  ],
  "connectionRules": [
    {
      "type": "membership",
      "name": "Member of",
      "from": {
        "objectType": "ad-user"
      },
      "to": {
        "objectType": "ad-security-group",
        "arrayProperty": "Members"
      }
    },
    {
      "type": "site-owner",
      "name": "Site Owner",
      "from": {
        "objectType": "ad-user"
      },
      "to": {
        "objectType": "sp-onprem-site",
        "arrayProperty": "Owners"
      }
    },
    {
      "type": "site-member",
      "name": "Site Member",
      "from": {
        "objectType": "ad-user"
      },
      "to": {
        "objectType": "sp-onprem-site",
        "arrayProperty": "Members"
      }
    },
    {
      "type": "hosted-on",
      "name": "Hosted on",
      "from": {
        "objectType": "infopath-form"
      },
      "to": {
        "objectType": "sp-onprem-site",
        "property": "ConnectedSite"
      }
    },
    {
      "type": "runs-on",
      "name": "Runs on",
      "from": {
        "objectType": "sp-workflow"
      },
      "to": {
        "objectType": "sp-onprem-site",
        "property": "ConnectedSite"
      }
    }
  ]
}
